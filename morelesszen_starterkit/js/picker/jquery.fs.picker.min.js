/*
 * Picker Plugin
 * @author Ben Plum
 * @version 0.3.2
 *
 * Copyright Â© 2013 Ben Plum <mr@benplum.com>
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
 
if(jQuery)(function(b){function s(a){a=b.extend({},q,a);for(var c=b(this),d=0,h=c.length;d<h;d++){var e=c.eq(d),f=a;if(!e.data("picker")){var f=b.extend({},f,e.data("picker-options")),k=b("label[for="+e.attr("id")+"]"),g=b(e.parents("label")[0]==k[0]?b.merge([],k):b.merge(b.merge([],e),k)),r=e.attr("type"),l="picker-"+("radio"==r?"radio":"checkbox"),p=e.attr("name"),m='<div class="picker-handle"><div class="picker-flag" /></div>';f.toggle&&(l+=" picker-toggle",m='<span class="picker-toggle-label on">'+f.labelOn+ '</span><span class="picker-toggle-label off">'+f.labelOff+"</span>"+m);g.wrapAll('<div class="picker '+l+" "+f.customClass+'" />');e.addClass("picker-element").after(m);k.addClass("picker-label");g=e.parents(".picker");l=g.find(".picker-handle");m=g.find(".picker-toggle-label");e.is(":checked")&&g.addClass("checked");e.is(":disabled")&&g.addClass("disabled");b.extend(f,{$picker:g,$input:e,$handle:l,$label:k,$labels:m,group:p,isRadio:"radio"==r,isCheckbox:"checkbox"==r});e.on("focus.picker",f,t).on("blur.picker", f,u).on("change.picker",f,v).on("deselect.picker",f,n);g.on("click.picker",f,w).data("picker",f)}}return c}function w(a){a.preventDefault();a.stopPropagation();var c=a.data;c.$input.is(":disabled")||(c.$input.is(":checked")?c.isRadio||n(a):h(a))}function v(a,c){if(!c){var b=a.data;b.$input.is(":disabled")||(b.$input.is(":checked")?h(a,!0):n(a,!0))}}function h(a,c){var d=a.data;"undefined"!==typeof d.group&&d.isRadio&&b('input[name="'+d.group+'"]').not(d.$input).trigger("deselect");d.$input.prop("checked", !0);d.$picker.addClass("checked");c||d.$input.trigger("change",[!0])}function n(a,b){var d=a.data;d.$input.prop("checked",!1);d.$picker.removeClass("checked");b||d.$input.trigger("change",[!0])}function t(a){a.data.$picker.addClass("focus")}function u(a){a.data.$picker.removeClass("focus")}var q={customClass:"",toggle:!1,labelOn:"ON",labelOff:"OFF"},p={defaults:function(a){q=b.extend(q,a||{});return b(this)},disable:function(){return b(this).each(function(a){a=b(this);var c=a.parent(".picker");a.prop("disabled", !0);c.addClass("disabled")})},enable:function(){return b(this).each(function(a){a=b(this);var c=a.parent(".picker");a.prop("disabled",!1);c.removeClass("disabled")})},destroy:function(){return b(this).each(function(a){a=b(this);var c=a.parent(".picker"),d=c.find(".picker-handle"),h=c.find(".picker-toggle-label"),e=b("label[for="+a.attr("id")+"]");c.off(".picker");d.remove();h.remove();a.off(".picker").removeClass("picker-element").unwrap();e.removeClass("picker-label")})},update:function(){return b(this).each(function(a){a= b(this);var c=a.parent(".picker").data("picker");a.is(":disabled")||(a.is(":checked")?h({data:c},!0):n({data:c},!0))})}};b.fn.picker=function(a){return p[a]?p[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof a&&a?this:s.apply(this,arguments)}})(jQuery);